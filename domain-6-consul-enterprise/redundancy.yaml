Consul 01:

data_dir =  "/root/consul"
bind_addr = "172.17.0.2"
client_addr = "0.0.0.0"
bootstrap_expect = 3
server = true
node_meta {
  zone = "zone1"
}

consul agent --config-dir /etc/consul.d/

Consul 02:

data_dir =  "/root/consul"
bind_addr = "172.17.0.3"
client_addr = "0.0.0.0"
bootstrap_expect = 3
start_join = ["172.17.0.2"]
server = true
node_meta {
  zone = "zone2"
}

consul agent --config-dir /etc/consul.d/

Consul 03:

data_dir =  "/root/consul"
bind_addr = "172.17.0.4"
client_addr = "0.0.0.0"
bootstrap_expect = 3
start_join = ["172.17.0.2"]
server = true
node_meta {
  zone = "zone3"
}

consul agent --config-dir /etc/consul.d/

Update Autopilot configuration to reflect node_meta:

consul operator autopilot set-config -redundancy-zone-tag=zone
consul operator autopilot get-config
consul operator raft list-peers

Consul 04:

data_dir =  "/root/consul"
bind_addr = "172.17.0.5"
client_addr = "0.0.0.0"
bootstrap_expect = 3
server = true
start_join = ["172.17.0.2"]
node_meta {
  zone = "zone1"
}
autopilot {
  redundancy_zone_tag = "zone"
}

consul agent --config-dir /etc/consul.d/

Consul 05:

data_dir =  "/root/consul"
bind_addr = "172.17.0.6"
client_addr = "0.0.0.0"
bootstrap_expect = 3
start_join = ["172.17.0.2"]
server = true
node_meta {
  zone = "zone2"
}
autopilot {
  redundancy_zone_tag = "zone"
}

consul agent --config-dir /etc/consul.d/

Consul 06:

data_dir =  "/root/consul"
bind_addr = "172.17.0.7"
client_addr = "0.0.0.0"
bootstrap_expect = 3
start_join = ["172.17.0.2"]
server = true
node_meta {
  zone = "zone3"
}
autopilot {
  redundancy_zone_tag = "zone"
}

consul agent -config-dir /etc/consul.d/
